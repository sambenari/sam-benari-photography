<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sam Benari — Black & White Street Photography</title>
  <meta name="description" content="Sam Benari — Black & White Street Photography" />
  <link rel="stylesheet" href="assets/main.css" />
</head>
<body>
  <header class="wrap">
    <a class="brand" href="index.html">Sam Benari</a>
    <nav>
      <a href="about.html">About</a>
      <a href="mailto:sam.benari@me.com">Contact</a>
    </nav>
  </header>

  <main class="wrap">
    <!-- HERO populated from site.json -->
    <section id="hero" class="hero"></section>

    <h2>Projects</h2>
    <div id="project-list" class="project-list"></div>
  </main>

  <footer class="wrap">
    <div>© Sam Benari</div>
    <div><a href="https://instagram.com/sambenari" target="_blank" rel="noopener">Instagram</a></div>
  </footer>

  <script>
  // Helper to fetch JSON without cache
  async function getJSON(path) {
    const res = await fetch(path, { cache: 'no-store' });
    if (!res.ok) throw new Error(path + ' HTTP ' + res.status);
    return res.json();
  }

  // Load hero from site.json
  async function loadHero() {
    try {
      const data = await getJSON('site.json');
      const hero = data?.hero || {};
      const headline = hero.headline || '';
      const subtext  = hero.subtext || '';
      const src      = hero.src || '';
      const alt      = hero.alt || 'Homepage hero';

      const el = document.getElementById('hero');
      el.innerHTML = `
        <div>
          <h1>${headline}</h1>
          <p class="muted">${subtext}</p>
        </div>
        ${src ? `<img class="cover" src="${src}" alt="${alt}">` : ''}
      `;
    } catch (e) {
      console.error('Failed to load hero from site.json', e);
      const el = document.getElementById('hero');
      el.innerHTML = `
        <div>
          <h1>Sam Benari Photography</h1>
          <p class="muted">Black & White Street Photography</p>
        </div>
      `;
    }
  }

  // Load project cards from manifests
  async function loadProjects() {
    const projects = [
      { slug: 'through-the-window' },
      { slug: 'cafe-life' },
      { slug: 'soho' },
      { slug: 'other-work' }
    ];
    const container = document.getElementById('project-list');

    for (const p of projects) {
      try {
        const m = await getJSON(`projects/${p.slug}/manifest.json`);
        const cover = m.cover || (m.images && m.images[0] && m.images[0].src) || 'images/placeholder-01.svg';
        const title = m.title || p.slug.replace(/-/g, ' ');
        const desc  = m.description || '';

        const card = document.createElement('a');
        card.className = 'card';
        card.href = `projects/${p.slug}/`;
        card.innerHTML = `
          <img src="projects/${p.slug}/${cover}" alt="${title} cover">
          <div class="meta">
            <h3>${title}</h3>
            <p>${desc}</p>
          </div>
        `;
        container.appendChild(card);
      } catch (err) {
        console.error('Failed to load', p.slug, err);
      }
    }
  }

  loadHero();
  loadProjects();
  </script>
</body>
</html>
